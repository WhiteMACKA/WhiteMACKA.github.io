<!DOCTYPE html>
<html lang="en">

<head>
    <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed|Tenor+Sans&display=swap" rel="stylesheet">

    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="js/main.js" defer></script>
    <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script>
        alert('Start 3')
        let WebApp = window.Telegram.WebApp;
        
        let demo_obj = {
            name: "John",
            age: 30,
            city: "New York"
        };

        let div = document.getElementById("myDiv");
        // let divDemo = document.getElementById("myDivDemo");
        let json_demo = JSON.stringify(demo_obj, null, 2); 
        //let json = JSON.stringify(WebApp, null, 2); 
        
        
        div.textContent = json;
        divDemo.textContent = json_demo;

        alert('1')
        let send = document.getElementById('send');
        alert('2')
        // WebApp.expand();
        alert('3')
        document.getElementById('full_name').value = WebApp.initDataUnsafe.user.first_name + " " + WebApp.initDataUnsafe.user.last_name;
        alert('4')
        
        send.addEventListener('click', () => {

            alert('Кнопка нажата')
            let full_name = document.getElementById('full_name').value;
            let post = document.getElementById('post').value;
            let phone = document.getElementById('phone').value;
            alert('Данные пользователя: ' + full_name + ' ' + post + ' ' + phone)
            
            let data = {
                user_name: full_name,
                user_post: post,
                user_phone: phone
            }

            alert('Отправляем')
            WebApp.sendData(JSON.stringify(data));          
            alert('Отправлены')

            WebApp.close();
        });
    </script>
    
    <title>Регистрация</title>

</head>

<body>

    <div class="wrapper">
        <div class="form">
            <form id="form" action="">

                <div class="title">Регистрация +</div>

                <div class="actions">
                    <div class="full_name item">
                        <label for="full_name">ФИО</label>
                        <input id="full_name" type="text" placeholder="Введите ФИО">
                    </div>
                    <div class="post item">
                        <label for="post">Должность</label>
                        <input id="post" type="text" placeholder="Введите Должность">
                    </div>
                    <div class="phone item">
                        <label for="phone">Телефон</label>
                        <input id="phone" type="tel" placeholder="Введите Телефон">
                    </div>
                </div>                

                <p>Объект:</p>
                <div id="myDiv"></div>
                <div id="myDivDemo"></div>

                <button id="send" type="action">Зарегистрировать</button>
            </form>
        </div>
    </div>

    <!-- <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script> -->
</body>

</html>
